<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Waktu Solat — Unified</title>
  <meta name="theme-color" content="#F6EEE0">

  <link rel="manifest" href="./manifest.json">
  <link rel="apple-touch-icon" href="./Images/icon-192.png">

  <style>
    :root{
      --bg:#F6EEE0; --card:#FFF; --muted:#6f604f; --accent:#A67734; --soft:#FFF6EE;
      --glass: rgba(255,255,255,0.28); --hero-height:360px;
      font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Noto Sans', Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:linear-gradient(180deg,var(--bg),#FFFDF8);color:#2e2a24;-webkit-font-smoothing:antialiased}
    a{color:inherit;text-decoration:none}

    /* HERO */
    .hero {
      position: relative;
      min-height: var(--hero-height);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 18px;
      background-size: cover;
      background-position: center;
      transition: background 1s ease;
    }
    .hero::before{content:'';position:absolute;inset:0;background:linear-gradient(180deg,rgba(0,0,0,0.12),rgba(0,0,0,0.02));z-index:0;border-bottom-left-radius:20px;border-bottom-right-radius:20px}
    .hero-card-bg{position:relative;z-index:2;width:100%;max-width:1100px;border-radius:16px;backdrop-filter: blur(10px);background:var(--glass);padding:16px;box-shadow:0 10px 30px rgba(16,12,8,0.08)}
    .hero-top{display:flex;justify-content:space-between;align-items:flex-start;gap:12px}
    .hero-left{display:flex;flex-direction:column;gap:6px}
    #locationName{font-weight:700;font-size:16px}
    #heroDate{font-size:13px;color:var(--muted)}
    .hero-right{text-align:right;display:flex;flex-direction:column;align-items:flex-end;gap:6px}
    #heroTime{font-size:34px;font-weight:700;letter-spacing:0.6px}
    #countdown{font-size:20px;font-weight:600;color:var(--muted)}
    #heroPrayers{margin-top:12px}
    #prayerNames,#prayerTimes{display:flex;justify-content:space-between;align-items:center;width:100%;font-weight:700}
    #prayerNames div,#prayerTimes div{flex:1;text-align:center;font-size:14px;color:var(--muted)}
    #prayerTimes div{color:#2e2a24}

    /* NAV */
    .site-nav{position:sticky;top:0;background:var(--accent);z-index:120;padding:10px 0;box-shadow:0 3px 12px rgba(0,0,0,0.08)}
    .nav-list{list-style:none;margin:0;padding:0;display:flex;gap:12px;justify-content:center;align-items:center;flex-wrap:wrap}
    .nav-list a{color:#fff;font-weight:700;padding:8px 14px;border-radius:8px;transition:transform .15s,background .15s}
    .nav-list a:hover{transform:translateY(-3px);background:rgba(255,255,255,0.12)}
    .nav-list a.active{background:#fff;color:var(--accent)}

    .container{max-width:1100px;margin:14px auto;padding:0 12px}
    main{padding:18px;max-width:1100px;margin:18px auto}
    .grid{display:grid;grid-template-columns:1fr 420px;gap:14px}
    .card{background:var(--card);border-radius:14px;padding:14px;box-shadow:0 6px 20px rgba(18,15,12,0.06)}
    .prayer-table table{width:100%;border-collapse:collapse;margin-top:8px}
    .prayer-table th,.prayer-table td{padding:10px 8px;text-align:left;border-bottom:1px solid #f3f3f3}

    .btn{padding:6px 10px;border:none;border-radius:6px;cursor:pointer;background:#A67734;color:white;font-weight:600}
    .btn.ghost{background:#fff;border:1px solid #A67734;color:#A67734}
    iframe.takwim-frame{width:100%;height:420px;border-radius:12px;border:0;background:#fff}
    @media (max-width:1100px){ .grid{grid-template-columns:1fr 1fr} }
    @media (max-width:900px){ .grid{grid-template-columns:1fr} .hero{min-height:260px} #heroTime{font-size:28px} iframe.takwim-frame{height:520px} }

    /* compact qibla wrapper (iframe scaled) */
    #qiblaWrapper { margin-top:12px; display:flex; justify-content:center; overflow:hidden; width:100%; height:300px; cursor:pointer; align-items:center;}
    #qiblatFrame { width:400px; height:400px; transform:scale(0.6); transform-origin: top center; border:none; }

    /* PWA Install Popup */
    .pwa-install {
      position: fixed;
      bottom: -200px;
      left: 50%;
      transform: translateX(-50%);
      width: 280px;
      background: #ffffff;
      color: #2b2b2b;
      border-radius: 12px;
      box-shadow: 0 8px 28px rgba(0,0,0,0.25);
      padding: 12px;
      display: flex;
      align-items: center;
      gap: 10px;
      z-index: 9999;
      opacity: 0;
      transition: all 0.45s ease-in-out;
      font-family: inherit;
    }
    .pwa-install.show { bottom: 25px; opacity: 1; }
    .pwa-install.hidden { display: none !important; }
    .pwa-inner { display: flex; align-items: center; gap: 10px; }
    .pwa-icon { width: 48px; height: 48px; border-radius: 10px; }
    .pwa-text { flex: 1; font-size: 14px; line-height: 1.2em; }
    .pwa-buttons { display:flex; flex-direction: column; gap:4px; }
    .pwa-install-btn { background: #0a7cff; color:#fff; border:none; padding:6px 10px; border-radius:6px; cursor:pointer; font-size:13px; }
    .pwa-close-btn { background:transparent; color:#777; border:none; padding:4px 6px; cursor:pointer; font-size:11px; }
  </style>
</head>
<body>

  <!-- HERO -->
  <header class="hero" id="hero" role="banner" aria-label="Prayer hero">
    <div class="hero-card-bg" id="heroCard">
      <div class="hero-top">
        <div class="hero-left">
          <div id="locationName">—</div>
          <div id="heroDate">—</div>
        </div>

        <div class="hero-right">
          <div id="heroTime">--:--:--</div>
          <div id="countdown">—</div>
          <div id="nextPrayer">Next: —</div>
        </div>
      </div>

      <div style="height:1px;background:rgba(0,0,0,0.03);margin:10px 0;border-radius:2px" aria-hidden="true"></div>

      <div id="heroPrayers" aria-live="polite">
        <div id="prayerNames" aria-hidden="false"></div>
        <div id="prayerTimes" aria-hidden="false"></div>
      </div>
    </div>
  </header>

  <!-- NAV -->
  <nav class="site-nav" aria-label="Primary">
    <div class="nav-bar container" style="background:transparent;">
      <ul class="nav-list" role="menubar" aria-label="Main navigation">
        <li role="none"><a role="menuitem" href="#prayer" class="active">Prayer</a></li>
        <li role="none"><a role="menuitem" href="quran.html">Al Quran</a></li>
        <li role="none"><a role="menuitem" href="#qiblaWrapper">Qiblat</a></li>
        <li role="none"><a role="menuitem" href="#takwimFrame">Takwim</a></li>
        <li role="none"><a role="menuitem" href="#hadith">Daily Hadis</a></li>
        <li role="none"><a role="menuitem" href="#about">About</a></li>
      </ul>
    </div>
  </nav>

  <main class="container">
    <div class="grid" id="mainGrid">
      <!-- LEFT BOX -->
      <section>
        <div class="card prayer-table" id="prayer">
          <div style="display:flex;justify-content:space-between;align-items:center;gap:8px;">
            <div>
              <strong id="locationNameSmall">Unknown</strong>
              <div style="color:var(--muted);font-size:13px">Prayer times today</div>
            </div>
            <div style="text-align:right">
              <div id="worldTime" style="font-weight:700"></div>
              <div style="color:var(--muted);font-size:12px">Local time</div>
            </div>
          </div>

          <div id="tableWrapper" style="margin-top:10px;">
            <table aria-label="Prayer times table">
              <thead><tr><th>Prayer</th><th>Time</th></tr></thead>
              <tbody id="prayerTableBody">
                <tr id="row-fajr"><td>Fajr</td><td id="pt-fajr">--:--</td></tr>
                <tr id="row-dhuhr"><td>Dhuhr</td><td id="pt-dhuhr">--:--</td></tr>
                <tr id="row-asr"><td>Asr</td><td id="pt-asr">--:--</td></tr>
                <tr id="row-maghrib"><td>Maghrib</td><td id="pt-maghrib">--:--</td></tr>
                <tr id="row-isha"><td>Isha</td><td id="pt-isha">--:--</td></tr>
              </tbody>
            </table>
          </div>

          <div style="margin-top:12px;display:flex;gap:8px;align-items:center;justify-content:space-between">
            <div style="display:flex;gap:8px;align-items:center">
              <button class="btn" id="toggle24">24h: On</button>
              <button class="btn ghost" id="setLocationBtn">Set Location</button>
            </div>
            <div style="color:var(--muted);font-size:13px">Next: <span id="nextPrayerLabel">—</span></div>
          </div>
        </div>

        <div class="card" id="hadith" style="margin-top:14px">
          <div style="display:flex;justify-content:space-between;align-items:center"><strong>Daily Hadith</strong><div style="color:var(--muted);font-size:13px">Quote image (offline friendly)</div></div>
          <div style="display:flex;gap:10px;margin-top:10px;align-items:center">
            <canvas id="hadithCanvas" width="160" height="160" style="border-radius:8px;background:linear-gradient(180deg,#fff,#FFF6EE)"></canvas>
            <div><div id="hadithText" style="font-weight:600">Loading hadith…</div><div style="color:var(--muted);font-size:13px">Source: sample</div></div>
          </div>
        </div>
      </section>

      <!-- RIGHT BOX -->
      <aside>
        <div class="card" style="margin-top:14px;">
          <div id="qiblaWrapper">
            <iframe id="qiblatFrame" src="qiblat.html" title="Qiblat (embedded)" aria-hidden="true"></iframe>
          </div>
          <div style="margin-top:8px;text-align:center;color:var(--muted)"><span id="qiblaDegDisplay">—°</span></div>
        </div>

        <div class="card" id="takwimCard" style="margin-top:14px;display:flex;flex-direction:column;gap:12px">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <strong>Takwim & Hijri</strong>
            <div style="font-size:13px;color:var(--muted)">7-day view • Full takwim below</div>
          </div>

          <iframe id="takwimFrame" class="takwim-frame" src="takwim-hijri.html" title="Takwim Hijri (embedded)"></iframe>

          <div style="display:flex;gap:8px;justify-content:flex-end">
            <button class="btn" id="openTakwimFull">Open Full</button>
          </div>
        </div>
      </aside>
    </div>

    <!-- PWA Install Popup -->
    <div id="pwaInstallPrompt" class="pwa-install hidden" role="dialog" aria-label="Install app">
      <div class="pwa-inner">
        <img src="./Images/icon-192.png" alt="App Icon" class="pwa-icon">
        <div class="pwa-text">
          <strong>Install Waktu Solat Lite</strong><br>
          <small>Fast access • Offline support • Lightweight</small>
        </div>
        <div class="pwa-buttons">
          <button id="installBtn" class="pwa-install-btn">Install</button>
          <button id="closeInstall" class="pwa-close-btn">Later</button>
        </div>
      </div>
    </div>

  </main>

  <footer style="text-align:center;padding:12px;color:var(--muted)">Built with care • Works offline-ish • Customize translations/data</footer>

  <!-- load adhan then app.js -->
  <script src="https://cdn.jsdelivr.net/npm/adhan@4.1.2/dist/adhan.min.js"></script>
  <script defer src="./app.js"></script>
  
</body>
</html>
