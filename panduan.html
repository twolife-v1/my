<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pustaka Ilmu - 100+ Articles</title>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* --- THEME VARIABLES --- */
        :root[data-theme="light"] { 
            --primary: #855e2e; --primary-light: #fdf8f2; 
            --bg: #f3f4f6; --surface: #ffffff; 
            --text: #1f2937; --text-muted: #6b7280; 
            --border: #e5e7eb; --shadow: 0 4px 6px -1px rgba(0,0,0,0.05);
        }
        :root[data-theme="dark"] { 
            --primary: #d4af37; --primary-light: #2a2215; 
            --bg: #111827; --surface: #1f2937; 
            --text: #f9fafb; --text-muted: #9ca3af; 
            --border: #374151; --shadow: 0 4px 6px -1px rgba(0,0,0,0.3);
        }
        
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; padding: 0; font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text); padding-bottom: 90px; }

        /* --- UI COMPONENTS --- */
        .app-header { background: var(--surface); padding: 15px 20px; position: sticky; top: 0; z-index: 50; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; padding-top: max(15px, env(safe-area-inset-top)); }
        .brand { font-family: 'Amiri', serif; font-size: 20px; font-weight: 700; color: var(--primary); display: flex; align-items: center; gap: 8px; }
        .icon-btn { background: transparent; border: 1px solid var(--border); width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: var(--text); cursor: pointer; }
        
        /* Nav & Search */
        .search-container { padding: 15px 20px 10px 20px; background: var(--bg); position: sticky; top: 65px; z-index: 40; }
        .search-box { width: 100%; padding: 12px 16px; border-radius: 12px; border: 1px solid var(--border); background: var(--surface); color: var(--text); outline: none; font-size: 15px; box-shadow: var(--shadow); }
        .search-box:focus { border-color: var(--primary); }
        
        .nav-scroller { display: flex; gap: 8px; overflow-x: auto; padding: 0 20px 15px 20px; scrollbar-width: none; -ms-overflow-style: none; }
        .nav-scroller::-webkit-scrollbar { display: none; }
        .nav-pill { padding: 6px 16px; border-radius: 20px; font-size: 12px; font-weight: 600; background: var(--surface); border: 1px solid var(--border); color: var(--text-muted); white-space: nowrap; cursor: pointer; transition: 0.2s; }
        .nav-pill.active { background: var(--primary); color: #fff; border-color: var(--primary); }

        /* Grid & Cards */
        .library-stats { padding: 0 20px 10px 20px; font-size: 11px; color: var(--text-muted); font-weight: 600; letter-spacing: 0.5px; text-transform: uppercase; }
        .library-grid { padding: 0 20px; display: grid; gap: 10px; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); }
        
        .book-card { background: var(--surface); border-radius: 14px; padding: 14px; display: flex; align-items: center; border: 1px solid var(--border); cursor: pointer; transition: transform 0.1s; position: relative; }
        .book-card:active { transform: scale(0.98); background: var(--primary-light); }
        .book-icon { width: 40px; height: 40px; border-radius: 10px; background: var(--primary-light); color: var(--primary); display: flex; align-items: center; justify-content: center; font-size: 20px; margin-right: 12px; flex-shrink: 0; }
        .book-info { flex: 1; min-width: 0; }
        .book-title { font-weight: 700; font-size: 14px; margin-bottom: 3px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .tag { padding: 2px 6px; border-radius: 4px; font-weight: 700; text-transform: uppercase; font-size: 9px; display: inline-block; }

        /* Category Colors */
        .tag-asas { background: #ccfbf1; color: #0f766e; }
        .tag-fardhu { background: #e0f2fe; color: #0369a1; }
        .tag-sunat { background: #ffedd5; color: #c2410c; }
        .tag-sirah { background: #fef9c3; color: #854d0e; }
        .tag-tokoh { background: #fae8ff; color: #86198f; }
        .tag-surah { background: #fce7f3; color: #be185d; }
        .tag-doa { background: #ede9fe; color: #6d28d9; }
        .tag-adab { background: #dcfce7; color: #15803d; }
        
        :root[data-theme="dark"] .tag-asas { background: #115e59; color: #99f6e4; }
        :root[data-theme="dark"] .tag-fardhu { background: #075985; color: #bae6fd; }
        :root[data-theme="dark"] .tag-sunat { background: #7c2d12; color: #fdba74; }
        :root[data-theme="dark"] .tag-sirah { background: #713f12; color: #fef08a; }
        :root[data-theme="dark"] .tag-tokoh { background: #701a75; color: #f5d0fe; }
        :root[data-theme="dark"] .tag-surah { background: #831843; color: #fbcfe8; }
        :root[data-theme="dark"] .tag-doa { background: #5b21b6; color: #ddd6fe; }
        :root[data-theme="dark"] .tag-adab { background: #166534; color: #bbf7d0; }

        /* --- CENTERED MODAL STYLE (Matches Hadis Harian) --- */
        #readerModal {
            position: fixed; inset: 0; z-index: 500;
            background: rgba(0, 0, 0, 0.75); /* Dark Overlay */
            backdrop-filter: blur(4px);      /* Blur Effect */
            display: none; align-items: center; justify-content: center;
            padding: 20px;
        }
        #readerModal.open {
            display: flex; animation: fadeIn 0.25s ease-out;
        }

        /* The Card Box inside the modal */
        .reader-card {
            width: 100%; max-width: 500px;
            height: 85vh; /* Maximum height */
            background: var(--surface); 
            border-radius: 24px; 
            display: flex; flex-direction: column; 
            overflow: hidden; 
            box-shadow: 0 20px 40px rgba(0,0,0,0.4);
            border: 1px solid var(--border);
            transform: scale(0.95); opacity: 0;
            animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes popIn { to { transform: scale(1); opacity: 1; } }

        /* Header & Content Adjustments */
        .reader-header {
            padding: 15px 20px; background: var(--surface);
            border-bottom: 1px solid var(--border);
            display: flex; justify-content: space-between; align-items: center;
            flex-shrink: 0;
        }
        .reader-content {
            flex: 1; overflow-y: auto; padding: 25px 20px;
            overscroll-behavior: contain;
        }

        /* --- CONTENT STYLING --- */
        .step-list { padding-left: 20px; margin: 10px 0; line-height: 1.6; }
        .step-list li { margin-bottom: 8px; }
        .bold-term { color: var(--primary); font-weight: 700; }
        .arabic-text { font-family: 'Amiri', serif; font-size: 20px; color: var(--primary); margin: 5px 0; display:block; }
        .highlight-box { background: var(--primary-light); padding: 15px; border-radius: 12px; border: 1px solid var(--border); margin-top: 15px; }

        /* Toast */
        .toast { position: fixed; bottom: 80px; left: 50%; transform: translate(-50%, 20px); background: #1f2937; color: white; padding: 10px 20px; border-radius: 50px; font-size: 13px; opacity: 0; pointer-events: none; transition: 0.3s; z-index: 200; box-shadow: 0 4px 12px rgba(0,0,0,0.2); }
        .toast.show { opacity: 1; transform: translate(-50%, 0); }

        /* Bottom Nav */
        .bottom-nav { position: fixed; bottom: 0; left: 0; right: 0; background: var(--surface); border-top: 1px solid var(--border); padding: 8px 20px 20px 20px; display: flex; justify-content: space-around; z-index: 40; }
        .nav-item { display: flex; flex-direction: column; align-items: center; color: var(--text-muted); font-size: 10px; cursor: pointer; }
        .nav-item.active { color: var(--primary); }
        .nav-item svg { width: 24px; height: 24px; margin-bottom: 2px; }
        .saved-badge { position: absolute; top: 10px; right: 10px; color: var(--primary); display: none; }
        .book-card.saved .saved-badge { display: block; }
    </style>
</head>
<body>

    <div class="app-header">
        <div class="brand"><span>ğŸ“š</span> Pustaka Ilmu</div>
        <div style="display:flex; gap:10px;">
            <button class="icon-btn" onclick="toggleLang()" id="langBtn" style="font-weight:700; font-size:11px;">EN</button>
            <button class="icon-btn" onclick="toggleTheme()">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
            </button>
        </div>
    </div>

    <div id="mainView">
        <div class="search-container">
            <input type="text" class="search-box" id="searchInput" placeholder="Cari artikel..." onkeyup="renderLibrary()">
        </div>

        <div class="nav-scroller" id="catContainer"></div>
        
        <div class="library-stats" id="libStats">Loading...</div>
        <div class="library-grid" id="libraryGrid"></div>
    </div>

    <div id="savedView" style="display:none; padding-top:20px;">
        <div style="padding:0 20px; margin-bottom:15px;">
            <h2 style="margin:0; font-family:'Amiri',serif; color:var(--primary);">Koleksi Saya</h2>
        </div>
        <div class="library-grid" id="savedGrid"></div>
    </div>

    <div id="readerModal">
        <div class="reader-card">
            <div class="reader-header">
                <button class="icon-btn" onclick="closeReader()">âœ•</button>
                <div style="display:flex; gap:10px;">
                    <button class="icon-btn" onclick="adjustFont()">A+</button>
                    <button class="icon-btn" onclick="toggleSaveCurrent()" id="bookmarkBtn">â™¥</button>
                </div>
            </div>
            <div class="reader-content">
                <h1 id="artTitle" style="font-family:'Amiri',serif; color:var(--primary); text-align:center; margin-top:0;"></h1>
                <div id="artContent" class="article-text"></div>
            </div>
        </div>
    </div>

    <div id="toast" class="toast">Saved</div>

    <div class="bottom-nav">
        <div class="nav-item active" onclick="switchView('home')" id="nav-home">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect></svg>
            <span>Library</span>
        </div>
        <div class="nav-item" onclick="switchView('saved')" id="nav-saved">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"></path></svg>
            <span>Saved</span>
        </div>
    </div>

    <script>
        // --- 1. CONFIGURATION ---
        let state = {
            lang: localStorage.getItem('p100_lang') || 'ms',
            theme: localStorage.getItem('p100_theme') || 'light',
            saved: JSON.parse(localStorage.getItem('p100_saved')) || [],
            currentCat: 'all',
            currentId: null,
            fontSize: 17
        };

        const TEXT = {
            ms: { cats: { all: "Semua", asas: "Asas", fardhu: "Fardhu", sunat: "Solat Sunat", sirah: "Sirah", tokoh: "Tokoh", surah: "Surah", doa: "Doa", adab: "Adab" } },
            en: { cats: { all: "All", asas: "Basics", fardhu: "Obligatory", sunat: "Voluntary Prayers", sirah: "History", tokoh: "Figures", surah: "Surah", doa: "Dua", adab: "Etiquette" } }
        };

        // --- 2. EXPANDED DATABASE (REAL STEP-BY-STEP CONTENT) ---
        const LIBRARY = [
            // === ASAS (BASICS) ===
            { 
                id: 'a1', cat: 'asas', icon: 'ğŸ’§', 
                t: {ms:"Cara Ambil Wudhu (Lengkap)", en:"How to Perform Wudhu (Step-by-Step)"}, 
                c: {
                    ms:`<p>Berikut adalah cara wudhu yang sempurna mengikut sunnah:</p>
                        <ol class="step-list">
                            <li><b>Niat & Membasuh Tangan:</b> Baca Bismillah & basuh tangan hingga pergelangan (3x).</li>
                            <li><b>Berkumur:</b> Masukkan air ke mulut & kumur (3x).</li>
                            <li><b>Memasukkan Air ke Hidung:</b> Sedut air ke hidung & hembus keluar (3x).</li>
                            <li><b>Membasuh Muka:</b> Basuh seluruh muka dari anak rambut ke dagu, telinga ke telinga (3x) sambil berniat di hati: <br><span class="arabic-text">Ù†ÙÙˆÙÙŠÙ’ØªÙ Ø±ÙÙÙ’Ø¹Ù Ø§Ù„Ù’Ø­ÙØ¯ÙØ«Ù Ø§Ù„Ù’Ø£ÙØµÙ’ØºÙØ±Ù Ù„ÙÙ„Ù‡Ù ØªÙØ¹ÙØ§Ù„ÙÙ‰</span><br><i>(Sahaja aku mengangkat hadas kecil kerana Allah Taala)</i></li>
                            <li><b>Membasuh Tangan:</b> Basuh tangan kanan hingga siku (3x), kemudian tangan kiri (3x). Pastikan air rata.</li>
                            <li><b>Menyapu Kepala:</b> Sapu sebahagian kepala atau keseluruhan rambut dengan air (1x).</li>
                            <li><b>Membasuh Telinga:</b> Sapu telinga dalam & luar (3x).</li>
                            <li><b>Membasuh Kaki:</b> Basuh kaki kanan hingga buku lali (3x), kemudian kaki kiri (3x). Gosok celah jari.</li>
                            <li><b>Tertib:</b> Lakukan mengikut urutan.</li>
                        </ol>
                        <div class="highlight-box"><b>Doa Selepas Wudhu:</b><br>Asyhadu an la ilaha illallah wahdahu la syarikalah...</div>`,
                    en:`<p>Steps for a complete Wudhu according to Sunnah:</p>
                        <ol class="step-list">
                            <li><b>Intention & Hands:</b> Say Bismillah & wash hands to wrists (3x).</li>
                            <li><b>Mouth:</b> Rinse mouth thoroughly (3x).</li>
                            <li><b>Nose:</b> Sniff water into nose & blow out (3x).</li>
                            <li><b>Face:</b> Wash entire face (hairline to chin) (3x) while making intention inside heart.</li>
                            <li><b>Arms:</b> Wash right arm up to elbow (3x), then left arm (3x).</li>
                            <li><b>Head:</b> Wipe part or all of the head with wet hands (1x).</li>
                            <li><b>Ears:</b> Wipe inside and outside of ears (3x).</li>
                            <li><b>Feet:</b> Wash right foot up to ankle (3x), then left (3x). Wash between toes.</li>
                            <li><b>Order:</b> Must be done in this sequence.</li>
                        </ol>`
                } 
            },
            { 
                id: 'a2', cat: 'asas', icon: 'ğŸ›', 
                t: {ms:"Cara Mandi Wajib", en:"Ghusl (Major Ablution)"}, 
                c: {
                    ms:`<p>Mandi wajib diperlukan selepas haid, nifas, atau keluar mani.</p>
                        <h4 class="bold-term">Rukun (Wajib Buat):</h4>
                        <ol class="step-list">
                            <li><b>Niat:</b> <span class="arabic-text">Ù†ÙÙˆÙÙŠÙ’ØªÙ Ø±ÙÙÙ’Ø¹Ù Ø§Ù„Ù’Ø­ÙØ¯ÙØ«Ù Ø§Ù„Ù’Ø£ÙÙƒÙ’Ø¨ÙØ±Ù Ù„ÙÙ„Ù‡Ù ØªÙØ¹ÙØ§Ù„ÙÙ‰</span> (Sahaja aku mengangkat hadas besar kerana Allah Taala).</li>
                            <li><b>Meratakan Air:</b> Air mesti sampai ke seluruh anggota badan, kulit, dan rambut (celah lipatan, pusat, rambut tebal).</li>
                        </ol>
                        <h4 class="bold-term">Sunnah Mandi:</h4>
                        <ul class="step-list">
                            <li>Basuh tangan & kemaluan dahulu (hilangkan najis).</li>
                            <li>Ambil wudhu sebelum mula mandi.</li>
                            <li>Dahulukan anggota kanan.</li>
                            <li>Gosok badan (Dalk).</li>
                        </ul>`,
                    en:`<p>Required after menstruation, postpartum, or sexual impurity.</p>
                        <h4 class="bold-term">Integrals (Must Do):</h4>
                        <ol class="step-list">
                            <li><b>Intention:</b> (I intend to remove the major impurity for the sake of Allah).</li>
                            <li><b>Covering the body:</b> Water must reach every part of the body, skin, and hair roots.</li>
                        </ol>`
                } 
            },
            { 
                id: 'a3', cat: 'asas', icon: 'ğŸœï¸', 
                t: {ms:"Cara Tayammum", en:"How to Perform Tayammum"}, 
                c: {
                    ms:`<p>Gunakan debu tanah yang suci apabila tiada air atau sakit menghalang guna air.</p>
                        <ol class="step-list">
                            <li><b>Niat:</b> <i>Sahaja aku bertayammum untuk mengharuskan solat kerana Allah Taala.</i></li>
                            <li><b>Tepuk Debu (1):</b> Tepuk kedua tangan ke tanah/debu, nipiskan debu (tepuk tangan sisi).</li>
                            <li><b>Sapu Muka:</b> Sapu seluruh muka dengan debu tadi.</li>
                            <li><b>Tepuk Debu (2):</b> Tepuk kali kedua di tempat debu yang baru.</li>
                            <li><b>Sapu Tangan:</b> Sapu tangan kanan hingga siku, kemudian tangan kiri hingga siku.</li>
                            <li><b>Tertib.</b></li>
                        </ol>`,
                    en:`<p>Use clean dust/earth when water is unavailable or harmful.</p>
                        <ol class="step-list">
                            <li><b>Intention:</b> I intend to perform Tayammum to permit prayer.</li>
                            <li><b>Strike 1:</b> Strike hands on dust, shake off excess.</li>
                            <li><b>Face:</b> Wipe the entire face once.</li>
                            <li><b>Strike 2:</b> Strike hands on new dust.</li>
                            <li><b>Arms:</b> Wipe right arm to elbow, then left arm to elbow.</li>
                        </ol>`
                } 
            },

            // === FARDHU (OBLIGATORY) ===
            { 
                id: 'f1', cat: 'fardhu', icon: 'ğŸ•Œ', 
                t: {ms:"Panduan Solat (Lengkap)", en:"Complete Guide to Salah"}, 
                c: {
                    ms:`<p>Turutan rukun fi'li (perbuatan) dalam solat:</p>
                        <ol class="step-list">
                            <li><b>Berdiri Tegak & Niat:</b> Berdiri bagi yang mampu. Niat dalam hati mengikut waktu solat.</li>
                            <li><b>Takbiratul Ihram:</b> Angkat tangan paras telinga, sebut "Allahu Akbar". Mata pandang tempat sujud.</li>
                            <li><b>Membaca Al-Fatihah:</b> Wajib dibaca dengan tertib dan tajwid setiap rakaat. (Bismillah adalah sebahagian Fatihah).</li>
                            <li><b>Rukuk:</b> Bungkuk badan 90 darjah, tangan pegang lutut. Baca tasbih 3x.</li>
                            <li><b>Iktidal:</b> Bangun tegak semula. Baca "Sami'allahu liman hamidah...".</li>
                            <li><b>Sujud:</b> Dahi, hidung, dua tapak tangan, dua lutut & perut jari kaki mesti kena lantai. Baca tasbih 3x.</li>
                            <li><b>Duduk Antara Dua Sujud:</b> Duduk iftirasy. Baca "Rabbighfirli...".</li>
                            <li><b>Sujud Kedua.</b></li>
                            <li><b>Tahiyat Akhir:</b> Duduk tawarruk, baca Tahiyat & Selawat Nabi.</li>
                            <li><b>Salam:</b> Beri salam kanan (wajib) & kiri (sunat).</li>
                        </ol>`,
                    en:`<p>Sequence of actions in Prayer:</p>
                        <ol class="step-list">
                            <li><b>Stand & Intention:</b> Stand upright facing Qibla. Intend specifically for the prayer.</li>
                            <li><b>Takbiratul Ihram:</b> Raise hands and say "Allahu Akbar".</li>
                            <li><b>Al-Fatihah:</b> Recite Surah Al-Fatihah (Obligatory in every rakaat).</li>
                            <li><b>Ruku' (Bowing):</b> Bow until back is level. Hands on knees.</li>
                            <li><b>Iktidal (Standing):</b> Return to standing position.</li>
                            <li><b>Sujud (Prostration):</b> 7 body parts must touch ground (Forehead, palms, knees, toes).</li>
                            <li><b>Sitting:</b> Sit between prostrations.</li>
                            <li><b>Final Tashahhud:</b> Recite Tahiyat and Salawat.</li>
                            <li><b>Salam:</b> Turn head to right (Peace be upon you).</li>
                        </ol>`
                } 
            },
            { 
                id: 'f2', cat: 'fardhu', icon: 'âš°ï¸', 
                t: {ms:"Cara Solat Jenazah", en:"Funeral Prayer Guide"}, 
                c: {
                    ms:`<p>Solat ini tiada Rukuk dan Sujud. Ia dilakukan berdiri dengan 4 Takbir.</p>
                        <ol class="step-list">
                            <li><b>Niat:</b> Sahaja aku solat jenazah (lelaki/perempuan) 4 takbir fardhu kifayah...</li>
                            <li><b>Takbir Pertama:</b> Baca <b>Surah Al-Fatihah</b>.</li>
                            <li><b>Takbir Kedua:</b> Baca <b>Selawat Ibrahimiyah</b> (Allahumma salli ala Muhammad...).</li>
                            <li><b>Takbir Ketiga:</b> Baca <b>Doa untuk Jenazah</b>.<br><i>(Allahummaghfirlahu warhamhu wa'afihi wa'fu 'anhu)</i></li>
                            <li><b>Takbir Keempat:</b> Baca doa kesejahteraan & Beri Salam kanan/kiri.</li>
                        </ol>`,
                    en:`<p>No bowing or prostration. Performed standing with 4 Takbirs.</p>
                        <ol class="step-list">
                            <li><b>Intention & Takbir 1:</b> Recite <b>Al-Fatihah</b>.</li>
                            <li><b>Takbir 2:</b> Recite <b>Salawat</b> (Blessings on Prophet).</li>
                            <li><b>Takbir 3:</b> Recite <b>Dua for Deceased</b> (O Allah forgive him/her...).</li>
                            <li><b>Takbir 4:</b> Recite final dua and give Salam.</li>
                        </ol>`
                } 
            },

            // === SUNAT (EXTRA) ===
            { 
                id: 's1', cat: 'sunat', icon: 'ğŸŒ¤ï¸', 
                t: {ms:"Cara Solat Dhuha", en:"How to perform Dhuha"}, 
                c: {
                    ms:`<p>Waktu: Selepas matahari naik (syuruk) hingga sebelum Zohor. Paling afdhal pukul 9-11 pagi.</p>
                        <ol class="step-list">
                            <li><b>Rakaat 1:</b> Baca Al-Fatihah & As-Syams (atau Al-Kafirun).</li>
                            <li><b>Rakaat 2:</b> Baca Al-Fatihah & Ad-Dhuha (atau Al-Ikhlas).</li>
                            <li>Lakukan seperti solat biasa 2 rakaat dan salam. Boleh buat 2, 4, 8 hingga 12 rakaat.</li>
                        </ol>
                        <div class="highlight-box"><b>Doa Dhuha:</b><br>Allahumma innad dhuha-a dhuha-uka... (Ya Allah, sesungguhnya waktu Dhuha itu Dhuha-Mu...)</div>`,
                    en:`<p>Time: After sunrise until just before Dhuhr. Best around 9-11 AM.</p>
                        <ol class="step-list">
                            <li><b>Rakaat 1:</b> Fatihah + Surah Ash-Shams.</li>
                            <li><b>Rakaat 2:</b> Fatihah + Surah Ad-Dhuha.</li>
                            <li>Perform like normal 2 rakaat prayer.</li>
                        </ol>`
                } 
            },

            // === DOA (SUPPLICATIONS) ===
             { 
                id: 'd1', cat: 'doa', icon: 'ğŸ¤²', 
                t: {ms:"Himpunan Doa Harian", en:"Daily Duas Collection"}, 
                c: {
                    ms:`<ul class="step-list">
                            <li><b>Sebelum Makan:</b><br><span class="arabic-text">Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ø¨ÙØ§Ø±ÙÙƒÙ’ Ù„ÙÙ†ÙØ§ ÙÙÙŠÙ…ÙØ§ Ø±ÙØ²ÙÙ‚Ù’ØªÙÙ†ÙØ§ ÙˆÙÙ‚ÙÙ†ÙØ§ Ø¹ÙØ°ÙØ§Ø¨Ù Ø§Ù„Ù†ÙÙ‘Ø§Ø±Ù</span></li>
                            <li><b>Selepas Makan:</b><br>Alhamdulillahilladzi at'amana wasaqana waja'alana minal muslimin.</li>
                            <li><b>Masuk Tandas:</b><br>Allahumma inni a'uzubika minal khubuthi wal khaba'ith.</li>
                            <li><b>Keluar Tandas:</b><br>Ghufranaka. Alhamdulillahilladzi azhaba 'annil aza wa'afani.</li>
                            <li><b>Naik Kenderaan:</b><br>Subhanalladzi sakhara lana haza wama kunna lahu muqrinin.</li>
                        </ul>`,
                    en:`<ul class="step-list">
                            <li><b>Before Eating:</b> Allahumma barik lana fima razaqtana...</li>
                            <li><b>Toilet Entry:</b> O Allah, I seek refuge from male/female syaitans.</li>
                            <li><b>Vehicle:</b> Glory to Him who has subjected this to us...</li>
                        </ul>`
                } 
            },

            // === SIRAH (HISTORY) ===
            { 
                id: 'h1', cat: 'sirah', icon: 'ğŸ“œ', 
                t: {ms:"Ringkasan Sirah Nabi SAW", en:"Prophet Muhammad's Life Summary"}, 
                c: {
                    ms:`<p>Peristiwa penting dalam kehidupan Rasulullah SAW:</p>
                        <ol class="step-list">
                            <li><b>Kelahiran (Tahun Gajah):</b> Lahir di Mekah, Isnin 12 Rabiul Awal. Yatim sejak dalam kandungan (Bapa: Abdullah meninggal).</li>
                            <li><b>Wahyu Pertama (Umur 40):</b> Di Gua Hira'. Malaikat Jibril menyampaikan Surah Al-Alaq (Ayat 1-5). Bermulanya kenabian.</li>
                            <li><b>Dakwah (13 Tahun di Mekah):</b> 3 tahun secara rahsia, 10 tahun secara terang-terangan. Banyak penindasan berlaku.</li>
                            <li><b>Hijrah (Tahun 1H):</b> Perintah Allah berhijrah ke Madinah. Permulaan Kalendar Islam & pembinaan Negara Islam pertama.</li>
                            <li><b>Fathu Makkah (Tahun 8H):</b> Pembebasan Kota Mekah tanpa pertumpahan darah. Kaabah dibersihkan dari berhala.</li>
                            <li><b>Wafat (Tahun 11H):</b> Baginda wafat di Madinah pada usia 63 tahun.</li>
                        </ol>`,
                    en:`<p>Key events in the Prophet's life:</p>
                        <ol class="step-list">
                            <li><b>Birth:</b> Born in Mecca, 12 Rabiul Awal. Orphaned at birth.</li>
                            <li><b>First Revelation (Age 40):</b> Cave Hira. Surah Al-Alaq. Beginning of Prophethood.</li>
                            <li><b>Migration (Hijrah):</b> Moved to Madinah. Start of Islamic Calendar.</li>
                            <li><b>Conquest of Mecca:</b> Peaceful liberation of Mecca in 8AH.</li>
                            <li><b>Passing (Age 63):</b> Passed away in Madinah in 11AH.</li>
                        </ol>`
                } 
            },

            // === TOKOH (FIGURES) ===
            { 
                id: 't1', cat: 'tokoh', icon: 'ğŸŒŸ', 
                t: {ms:"5 Rasul Ulul Azmi", en:"The 5 Ulul Azmi Prophets"}, 
                c: {
                    ms:`<p>Gelaran bagi Rasul yang mempunyai ketabahan luar biasa semasa berdakwah:</p>
                        <ul class="step-list">
                            <li><b>Nabi Nuh AS:</b> Berdakwah selama 950 tahun tetapi sedikit pengikut. Diuji dengan banjir besar & isteri/anak yang ingkar.</li>
                            <li><b>Nabi Ibrahim AS:</b> Bapa para Nabi. Diuji dibakar Raja Namrud & perintah menyembelih anaknya Ismail. Membina Kaabah.</li>
                            <li><b>Nabi Musa AS:</b> Berhadapan dengan Firaun. Mukjizat membelah laut & Kitab Taurat.</li>
                            <li><b>Nabi Isa AS:</b> Lahir tanpa bapa. Mukjizat menghidupkan orang mati & menyembuhkan penyakit. Kitab Injil.</li>
                            <li><b>Nabi Muhammad SAW:</b> Penutup segala Nabi. Mukjizat Al-Quran & Isra' Mikraj.</li>
                        </ul>`,
                    en:`<p>Prophets known for their extraordinary patience and resolve:</p>
                        <ul class="step-list">
                            <li><b>Nuh (Noah):</b> Preached for 950 years. The Great Flood.</li>
                            <li><b>Ibrahim (Abraham):</b> The Fire test & Sacrifice test. Built the Kaaba.</li>
                            <li><b>Musa (Moses):</b> Confronted Pharaoh. Split the Sea.</li>
                            <li><b>Isa (Jesus):</b> Healing the sick. The Gospel.</li>
                            <li><b>Muhammad (SAW):</b> The Final Prophet. The Quran.</li>
                        </ul>`
                } 
            },

            // === SURAH (QURAN) ===
            { 
                id: 'q1', cat: 'surah', icon: 'ğŸ“–', 
                t: {ms:"Ayatul Kursi & Kelebihan", en:"Ayatul Kursi & Benefits"}, 
                c: {
                    ms:`<div class="highlight-box" style="text-align:center;">
                            <span class="arabic-text" style="font-size:24px; line-height:2.2;">
                            Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ù„ÙØ§ Ø¥ÙÙ„ÙÙ°Ù‡Ù Ø¥ÙÙ„ÙÙ‘Ø§ Ù‡ÙÙˆÙ Ø§Ù„Ù’Ø­ÙÙŠÙÙ‘ Ø§Ù„Ù’Ù‚ÙÙŠÙÙ‘ÙˆÙ…Ù...
                            </span>
                        </div>
                        <p><b>Kelebihan Mengamalkannya:</b></p>
                        <ul class="step-list">
                            <li><b>Selepas Solat:</b> Tiada penghalang antaranya dan Syurga melainkan mati. (Hadis Nasai)</li>
                            <li><b>Sebelum Tidur:</b> Allah melantik pelindung & syaitan tidak mendekati hingga subuh. (Hadis Bukhari)</li>
                            <li>Merupakan ayat paling agung dalam Al-Quran.</li>
                        </ul>`,
                    en:`<p><b>Benefits of Recitation:</b></p>
                        <ul class="step-list">
                            <li><b>After Prayer:</b> Only death stands between him and Paradise.</li>
                            <li><b>Before Sleep:</b> Protection from Allah; Satan cannot approach until dawn.</li>
                            <li>The greatest verse in the Quran.</li>
                        </ul>`
                } 
            },
            { 
                id: 'q2', cat: 'surah', icon: 'ğŸ‘‘', 
                t: {ms:"Surah Al-Mulk (Tabarak)", en:"Surah Al-Mulk"}, 
                c: {
                    ms:`<p>Surah ke-67, 30 Ayat.</p>
                        <ul class="step-list">
                            <li><b>Waktu Bacaan:</b> Sangat dianjurkan membaca setiap malam sebelum tidur.</li>
                            <li><b>Fadhilat:</b> Menjadi penghalang dan penyelamat daripada seksaan kubur.</li>
                            <li>Rasulullah SAW tidak akan tidur melainkan setelah membaca Surah As-Sajdah dan Al-Mulk. (Tirmidhi)</li>
                        </ul>`,
                    en:`<p>Surah 67, 30 Verses.</p>
                        <ul class="step-list">
                            <li><b>Time:</b> Recommended every night before sleep.</li>
                            <li><b>Benefit:</b> Intercedes for the reciter and protects from the punishment of the grave.</li>
                        </ul>`
                } 
            },

            // === ADAB (ETIQUETTE) ===
            { 
                id: 'ad1', cat: 'adab', icon: 'ğŸ›Œ', 
                t: {ms:"Adab Tidur Mengikut Sunnah", en:"Sunnah of Sleeping"}, 
                c: {
                    ms:`<ol class="step-list">
                            <li><b>Berwudhu:</b> Tidur dalam keadaan suci.</li>
                            <li><b>Kibas Tempat Tidur:</b> Kibas 3 kali sambil baca Bismillah.</li>
                            <li><b>Posisi:</b> Tidur mengiring ke kanan, tapak tangan kanan di bawah pipi.</li>
                            <li><b>Bacaan:</b> 
                                <ul>
                                    <li>Ayatul Kursi</li>
                                    <li>3 Qul (Al-Ikhlas, Al-Falaq, An-Nas) - Tiup tapak tangan & sapu badan.</li>
                                    <li>Doa Tidur: <i>Bismika Allahumma amutu wa ahya.</i></li>
                                </ul>
                            </li>
                            <li><b>Niat:</b> Berniat bangun awal untuk solat Tahajjud/Subuh.</li>
                        </ol>`,
                    en:`<ol class="step-list">
                            <li><b>Wudhu:</b> Sleep in a state of purity.</li>
                            <li><b>Dust the Bed:</b> Dust 3x saying Bismillah.</li>
                            <li><b>Position:</b> Lie on right side, right palm under cheek.</li>
                            <li><b>Recitations:</b> Ayatul Kursi, 3 Quls, Sleeping Dua.</li>
                        </ol>`
                } 
            },
            { 
                id: 'ad2', cat: 'adab', icon: 'ğŸ½ï¸', 
                t: {ms:"Adab Makan & Minum", en:"Etiquette of Eating"}, 
                c: {
                    ms:`<ol class="step-list">
                            <li><b>Basuh Tangan:</b> Pastikan kebersihan sebelum jamah makanan.</li>
                            <li><b>Mulakan dengan Bismillah:</b> Jika lupa, baca <i>"Bismillahi awwalahu wa akhirahu"</i>.</li>
                            <li><b>Guna Tangan Kanan:</b> Nabi melarang makan dengan tangan kiri (perbuatan syaitan).</li>
                            <li><b>Ambil Yang Hampir:</b> Makan lauk yang dekat dengan kita dahulu.</li>
                            <li><b>Jangan Mencela Makanan:</b> Jika suka makan, jika tidak suka tinggalkan tanpa hina.</li>
                            <li><b>Akhiri dengan Alhamdulillah.</b></li>
                        </ol>`,
                    en:`<ol class="step-list">
                            <li><b>Wash Hands:</b> Hygiene first.</li>
                            <li><b>Say Bismillah:</b> Use right hand only.</li>
                            <li><b>Eat what is near:</b> Don't reach over others.</li>
                            <li><b>Don't Criticize Food:</b> Eat if you like, leave it if you don't.</li>
                            <li><b>Say Alhamdulillah</b> after finishing.</li>
                        </ol>`
                }
            },            // === TAMBAHAN FARDHU (OBLIGATORY ADDITIONS) ===
            { 
                id: 'f3', cat: 'fardhu', icon: 'ğŸŒ™', 
                t: {ms:"Panduan Puasa Ramadhan", en:"Guide to Ramadan Fasting"}, 
                c: {
                    ms:`<p>Puasa adalah menahan diri dari lapar, dahaga, dan perkara yang membatalkan dari terbit fajar hingga terbenam matahari.</p>
                        <h4 class="bold-term">Niat Puasa (Harian):</h4>
                        <span class="arabic-text">Ù†ÙÙˆÙÙŠÙ’ØªÙ ØµÙÙˆÙ’Ù…Ù ØºÙØ¯Ù Ø¹ÙÙ†Ù’ Ø£ÙØ¯ÙØ§Ø¡Ù ÙÙØ±Ù’Ø¶Ù Ø±ÙÙ…ÙØ¶ÙØ§Ù†Ù Ù‡ÙØ°ÙÙ‡Ù Ø§Ù„Ø³ÙÙ‘Ù†ÙØ©Ù Ù„ÙÙ„ÙÙ‘Ù‡Ù ØªÙØ¹ÙØ§Ù„ÙÙ‰</span>
                        <i>"Sahaja aku berpuasa esok hari menunaikan fardhu Ramadhan tahun ini kerana Allah Taala."</i>
                        <h4 class="bold-term">Amalan Sunnah:</h4>
                        <ul class="step-list">
                            <li>Bersahur (lewatkan sahur).</li>
                            <li>Menyegerakan berbuka apabila masuk waktu Maghrib.</li>
                            <li>Berbuka dengan kurma atau air.</li>
                            <li>Membaca doa berbuka: <i>Allahumma laka sumtu...</i></li>
                        </ul>`,
                    en:`<p>Fasting is abstaining from food, drink, and invalidators from dawn to sunset.</p>
                        <h4 class="bold-term">Intention (Daily):</h4>
                        <i>"I intend to fast tomorrow for the obligation of Ramadan this year for the sake of Allah."</i>
                        <h4 class="bold-term">Sunnah Acts:</h4>
                        <ul class="step-list">
                            <li>Have Sahur (Pre-dawn meal).</li>
                            <li>Break fast immediately at Maghrib.</li>
                            <li>Break fast with dates or water.</li>
                        </ul>`
                } 
            },

            // === TAMBAHAN SUNAT (VOLUNTARY PRAYERS) ===
            { 
                id: 's2', cat: 'sunat', icon: 'ğŸŒŒ', 
                t: {ms:"Cara Solat Tahajjud", en:"How to perform Tahajjud"}, 
                c: {
                    ms:`<p>Dilakukan pada sepertiga malam terakhir selepas terjaga dari tidur. Ia adalah solat sunat yang paling afdhal.</p>
                        <ol class="step-list">
                            <li><b>Niat:</b> <i>Sahaja aku solat sunat Tahajjud dua rakaat kerana Allah Taala.</i></li>
                            <li><b>Rakaat 1:</b> Baca Al-Fatihah & Surah Al-Kafirun.</li>
                            <li><b>Rakaat 2:</b> Baca Al-Fatihah & Surah Al-Ikhlas.</li>
                            <li><b>Sujud Terakhir:</b> Digalakkan memperbanyakkan doa.</li>
                            <li><b>Salam.</b></li>
                        </ol>
                        <div class="highlight-box">Disarankan membaca doa khusus Tahajjud atau doa memohon keampunan (Istighfar).</div>`,
                    en:`<p>Performed in the last third of the night after waking up from sleep.</p>
                        <ol class="step-list">
                            <li><b>Intention:</b> <i>I intend to perform two rakaats of Tahajjud prayer for Allah.</i></li>
                            <li><b>Recitation:</b> Fatihah + Al-Kafirun (1st), Fatihah + Al-Ikhlas (2nd).</li>
                            <li><b>Last Sujood:</b> Recommended to make abundant Dua.</li>
                        </ol>`
                } 
            },
            { 
                id: 's3', cat: 'sunat', icon: '1ï¸âƒ£', 
                t: {ms:"Cara Solat Witir", en:"How to perform Witr"}, 
                c: {
                    ms:`<p>Solat penutup bagi solat malam. Bilangan rakaat ganjil (1, 3, 5, dll).</p>
                        <h4 class="bold-term">Cara 3 Rakaat (2 Salam):</h4>
                        <ol class="step-list">
                            <li><b>2 Rakaat Pertama:</b> Niat solat sunat Witir 2 rakaat. Baca Surah Al-A'la & Al-Kafirun. Salam.</li>
                            <li><b>1 Rakaat Terakhir:</b> Niat solat sunat Witir 1 rakaat. Baca 3 Qul (Al-Ikhlas, Al-Falaq, An-Nas).</li>
                            <li><b>Doa Qunut:</b> Disunatkan membaca Qunut pada rakaat terakhir bermula separuh kedua Ramadhan.</li>
                        </ol>`,
                    en:`<p>The closing prayer for the night. Performed in odd numbers.</p>
                        <h4 class="bold-term">Method for 3 Rakaats:</h4>
                        <ol class="step-list">
                            <li><b>First 2 Rakaats:</b> Recite Al-A'la & Al-Kafirun. Give Salam.</li>
                            <li><b>Last 1 Rakaat:</b> Recite 3 Quls. Give Salam.</li>
                            <li><b>Qunut:</b> Recommended in the second half of Ramadan.</li>
                        </ol>`
                } 
            },
            { 
                id: 's4', cat: 'sunat', icon: 'ğŸ¤²', 
                t: {ms:"Cara Solat Hajat", en:"How to perform Solat Hajat"}, 
                c: {
                    ms:`<p>Dilakukan apabila mempunyai hajat atau kesulitan.</p>
                        <ol class="step-list">
                            <li><b>Niat:</b> <i>Sahaja aku solat sunat Hajat dua rakaat kerana Allah Taala.</i></li>
                            <li><b>Rakaat 1:</b> Al-Fatihah & Ayatul Kursi (1x atau 7x).</li>
                            <li><b>Rakaat 2:</b> Al-Fatihah & Al-Ikhlas (1x atau 11x).</li>
                            <li><b>Selepas Salam:</b> Sujud sekali lagi dan baca tasbih Nabi Yunus: <br><i>La ilaha illa anta subhanaka inni kuntu minaz zalimin.</i></li>
                        </ol>`,
                    en:`<p>Performed when in need or difficulty.</p>
                        <ol class="step-list">
                            <li><b>Intention:</b> Solat Hajat 2 rakaats.</li>
                            <li><b>Recitation:</b> Fatihah + Ayatul Kursi (R1), Fatihah + Ikhlas (R2).</li>
                            <li><b>After Salam:</b> Prostrate again and recite Prophet Yunus's Tasbih.</li>
                        </ol>`
                } 
            },

            // === TAMBAHAN TOKOH (FIGURES ADDITIONS) ===
            { 
                id: 't2', cat: 'tokoh', icon: 'âš”ï¸', 
                t: {ms:"4 Khulafa Ar-Rasyidin", en:"The 4 Rightly Guided Caliphs"}, 
                c: {
                    ms:`<p>Sahabat Nabi yang memimpin umat Islam selepas kewafatan Baginda:</p>
                        <ul class="step-list">
                            <li><b>Abu Bakar As-Siddiq:</b> Sahabat paling rapat. Memerangi golongan murtad & nabi palsu. Mengumpul Al-Quran.</li>
                            <li><b>Umar Al-Khattab:</b> Digelar Al-Faruq (Pemisah Hak & Batil). Meluaskan empayar Islam (Parsi & Rom). Memulakan kalendar Hijrah.</li>
                            <li><b>Uthman Affan:</b> Digelar Zunnurain (Pemilik 2 Cahaya). Membukukan Al-Quran (Mushaf Uthmani). Dermawan.</li>
                            <li><b>Ali Abi Talib:</b> Sepupu & menantu Nabi. Kanak-kanak pertama memeluk Islam. Terkenal dengan ilmu & keberanian.</li>
                        </ul>`,
                    en:`<p>Leaders of the Ummah after the Prophet:</p>
                        <ul class="step-list">
                            <li><b>Abu Bakr:</b> Closest companion. Compiled the Quran.</li>
                            <li><b>Umar:</b> The Faruq. Expanded the empire. Established Hijri calendar.</li>
                            <li><b>Uthman:</b> Zunnurain. Standardized the Quran text.</li>
                            <li><b>Ali:</b> Cousin of Prophet. Known for wisdom and bravery.</li>
                        </ul>`
                } 
            },

            // === TAMBAHAN ADAB (ETIQUETTE ADDITIONS) ===
            { 
                id: 'ad3', cat: 'adab', icon: 'ğŸ•Œ', 
                t: {ms:"Adab Masuk Masjid", en:"Mosque Etiquette"}, 
                c: {
                    ms:`<ol class="step-list">
                            <li><b>Masuk Kaki Kanan:</b> Baca doa <i>Allahummaftah li abwaba rahmatik</i>.</li>
                            <li><b>Jangan Duduk Terus:</b> Lakukan solat sunat Tahiyatul Masjid 2 rakaat.</li>
                            <li><b>Jaga Kebersihan:</b> Pastikan pakaian bersih dan tidak berbau (seperti rokok/bawang).</li>
                            <li><b>Niat Iktikaf:</b> <i>Sahaja aku beriktikaf di masjid ini kerana Allah Taala.</i></li>
                            <li><b>Keluar Kaki Kiri:</b> Baca doa <i>Allahumma inni as'aluka min fadlik</i>.</li>
                        </ol>`,
                    en:`<ol class="step-list">
                            <li><b>Enter with Right Foot:</b> Recite entrance dua.</li>
                            <li><b>Tahiyatul Masjid:</b> Pray 2 rakaats before sitting.</li>
                            <li><b>Cleanliness:</b> Ensure clothes are clean and smell good.</li>
                            <li><b>Exit with Left Foot:</b> Recite exit dua.</li>
                        </ol>`
                } 
            },
            { 
                id: 'ad4', cat: 'adab', icon: 'ğŸš½', 
                t: {ms:"Adab Masuk Tandas", en:"Toilet Etiquette"}, 
                c: {
                    ms:`<ol class="step-list">
                            <li><b>Tutup Kepala:</b> Memakai alas kepala dan alas kaki.</li>
                            <li><b>Baca Doa:</b> Sebelum masuk, baca doa berlindung dari syaitan.</li>
                            <li><b>Masuk Kaki Kiri:</b> Dahulukan kaki kiri semasa masuk.</li>
                            <li><b>Jaga Aurat:</b> Jangan bercakap atau menyanyi di dalam tandas.</li>
                            <li><b>Keluar Kaki Kanan:</b> Baca <i>Ghufranaka</i> (Aku memohon keampunan-Mu).</li>
                        </ol>`,
                    en:`<ol class="step-list">
                            <li><b>Cover Head & Feet:</b> Wear slippers.</li>
                            <li><b>Recite Dua:</b> Before entering.</li>
                            <li><b>Enter Left, Exit Right.</b></li>
                            <li><b>Silence:</b> Do not talk or sing inside.</li>
                        </ol>`
                } 
            },
                // === TAMBAHAN SUNAT (MORE VOLUNTARY PRAYERS) ===
            { 
                id: 's5', cat: 'sunat', icon: 'ğŸ˜­', 
                t: {ms:"Cara Solat Taubat", en:"How to perform Solat Taubat"}, 
                c: {
                    ms:`<p>Dilakukan apabila seseorang menyedari dosa dan ingin kembali kepada Allah.</p>
                        <ol class="step-list">
                            <li><b>Niat:</b> <i>Sahaja aku solat sunat Taubat dua rakaat kerana Allah Taala.</i></li>
                            <li><b>Rakaat 1:</b> Baca Al-Fatihah & Al-Kafirun.</li>
                            <li><b>Rakaat 2:</b> Baca Al-Fatihah & Al-Ikhlas.</li>
                            <li><b>Sujud Terakhir:</b> Beristighfar dalam hati bersungguh-sungguh.</li>
                            <li><b>Selepas Salam:</b> Baca "Astaghfirullahal 'adzim" (100x) dan doa taubat nasuha.</li>
                        </ol>`,
                    en:`<p>Performed when repenting for sins.</p>
                        <ol class="step-list">
                            <li><b>Intention:</b> Solat Sunat Taubat 2 rakaats.</li>
                            <li><b>Recitation:</b> Fatihah + Al-Kafirun (R1), Fatihah + Al-Ikhlas (R2).</li>
                            <li><b>After Salam:</b> Recite "Astaghfirullah" 100x and make sincere dua.</li>
                        </ol>`
                } 
            },
            { 
                id: 's6', cat: 'sunat', icon: 'âœ¨', 
                t: {ms:"Cara Solat Istikharah", en:"Solat Istikharah (Guidance)"}, 
                c: {
                    ms:`<p>Dilakukan apabila keliru membuat pilihan (jodoh, kerjaya, dll).</p>
                        <ol class="step-list">
                            <li><b>Niat:</b> <i>Sahaja aku solat sunat Istikharah dua rakaat kerana Allah Taala.</i></li>
                            <li><b>Rakaat 1:</b> Baca Al-Fatihah & Al-Kafirun.</li>
                            <li><b>Rakaat 2:</b> Baca Al-Fatihah & Al-Ikhlas.</li>
                            <li><b>Selepas Salam:</b> Baca <b>Doa Istikharah</b> (Allahumma inni astakhiruka...).</li>
                        </ol>
                        <div class="highlight-box">Jawapan mungkin datang melalui mimpi, ketenangan hati, atau dipermudahkan urusan.</div>`,
                    en:`<p>Performed when seeking guidance on a decision.</p>
                        <ol class="step-list">
                            <li><b>Recitation:</b> Fatihah + Al-Kafirun (R1), Fatihah + Al-Ikhlas (R2).</li>
                            <li><b>After Salam:</b> Read the specific Dua Istikharah.</li>
                            <li><b>Result:</b> Look for peace of heart or ease in affairs.</li>
                        </ol>`
                } 
            },

            // === TAMBAHAN FARDHU (MORE OBLIGATORY) ===
            { 
                id: 'f4', cat: 'fardhu', icon: 'ğŸ’°', 
                t: {ms:"Panduan Zakat Fitrah", en:"Guide to Zakat Fitrah"}, 
                c: {
                    ms:`<p>Wajib dikeluarkan pada bulan Ramadhan sebelum Solat Raya.</p>
                        <ul class="step-list">
                            <li><b>Kadar:</b> Satu gantang Baghdad (anggaran 2.7kg beras atau nilai wang ditentukan kerajaan negeri).</li>
                            <li><b>Waktu Wajib:</b> Terbenam matahari akhir Ramadhan.</li>
                            <li><b>Waktu Afdhal:</b> Pagi raya sebelum solat sunat Aidilfitri.</li>
                            <li><b>Niat (Diri Sendiri):</b> <i>Inilah wang bagi menggantikan beras fitrah yang wajib ke atas diriku pada tahun ini kerana Allah Taala.</i></li>
                        </ul>`,
                    en:`<p>Obligatory charity paid in Ramadan before Eid Prayer.</p>
                        <ul class="step-list">
                            <li><b>Rate:</b> Equivalent to 2.7kg of staple food (rice) or cash value set by authority.</li>
                            <li><b>Best Time:</b> Morning of Eid before prayer.</li>
                        </ul>`
                } 
            },

            // === TAMBAHAN SURAH ===
            { 
                id: 'q3', cat: 'surah', icon: 'â›°ï¸', 
                t: {ms:"Kelebihan Surah Al-Kahfi", en:"Benefits of Surah Al-Kahfi"}, 
                c: {
                    ms:`<p>Disunatkan membaca pada hari Jumaat (Malam Jumaat hingga sebelum Maghrib hari Jumaat).</p>
                        <ul class="step-list">
                            <li><b>Dilindungi Dajjal:</b> Menghafal 10 ayat awal (atau akhir) akan dilindungi dari fitnah Dajjal. (Hadis Muslim)</li>
                            <li><b>Cahaya (Nur):</b> Allah akan menerangi antaranya dan Kaabah (atau dua Jumaat) dengan cahaya.</li>
                        </ul>`,
                    en:`<p>Recommended to read on Fridays.</p>
                        <ul class="step-list">
                            <li><b>Protection:</b> Memorizing first 10 verses protects from Dajjal.</li>
                            <li><b>Light:</b> Allah provides spiritual light between two Fridays.</li>
                        </ul>`
                } 
            },
            { 
                id: 'q4', cat: 'surah', icon: 'â¤ï¸', 
                t: {ms:"Kelebihan Surah Yasin", en:"Benefits of Surah Yasin"}, 
                c: {
                    ms:`<p>Digelar "Jantung Al-Quran".</p>
                        <ul class="step-list">
                            <li><b>Keampunan:</b> Sesiapa membacanya pada malam hari mencari redha Allah, diampunkan dosanya.</li>
                            <li><b>Memudahkan Urusan:</b> Sering dibaca untuk memohon hajat atau memudahkan sakaratul maut.</li>
                        </ul>`,
                    en:`<p>Known as the "Heart of the Quran".</p>
                        <ul class="step-list">
                            <li><b>Forgiveness:</b> Reciting at night seeks Allah's pleasure and forgiveness.</li>
                            <li><b>Ease:</b> Often recited for needs or easing death.</li>
                        </ul>`
                } 
            },

            // === TAMBAHAN ADAB ===
            { 
                id: 'ad5', cat: 'adab', icon: 'ğŸ‘•', 
                t: {ms:"Adab Berpakaian", en:"Etiquette of Dressing"}, 
                c: {
                    ms:`<ol class="step-list">
                            <li><b>Menutup Aurat:</b> Syarat wajib bagi lelaki dan wanita.</li>
                            <li><b>Mulakan Kanan:</b> Masukkan tangan/kaki kanan dahulu semasa memakai.</li>
                            <li><b>Tanggalkan Kiri:</b> Mulakan kiri semasa membuka pakaian.</li>
                            <li><b>Baca Doa:</b> <i>Allahumma inni as'aluka min khairihi...</i> (Ya Allah aku minta kebaikan pakaian ini).</li>
                            <li><b>Tidak Sombong:</b> Jangan memakai pakaian untuk menunjuk-nunjuk (Riya').</li>
                        </ol>`,
                    en:`<ol class="step-list">
                            <li><b>Cover Aurat:</b> Obligatory for both genders.</li>
                            <li><b>Right First:</b> Put on right limb first.</li>
                            <li><b>Left Last:</b> Take off left limb first.</li>
                            <li><b>Modesty:</b> Do not dress to show off arrogance.</li>
                        </ol>`
                } 
            },
             { 
                id: 'ad6', cat: 'adab', icon: 'ğŸ¤', 
                t: {ms:"Adab Ziarah & Tetamu", en:"Etiquette of Visiting"}, 
                c: {
                    ms:`<ol class="step-list">
                            <li><b>Beri Salam:</b> Ucap salam sebelum masuk rumah (maksimum 3 kali).</li>
                            <li><b>Masa Sesuai:</b> Elakkan waktu tidur atau istirahat tuan rumah.</li>
                            <li><b>Jaga Pandangan:</b> Jangan melilau melihat isi rumah orang.</li>
                            <li><b>Muliakan Tetamu:</b> Tuan rumah wajib memuliakan tetamu (sediakan air/makanan semampu boleh).</li>
                        </ol>`,
                    en:`<ol class="step-list">
                            <li><b>Salam:</b> Announce arrival with Salam (max 3 times).</li>
                            <li><b>Timing:</b> Avoid rest times.</li>
                            <li><b>Gaze:</b> Do not spy on the house interior.</li>
                            <li><b>Honor Guest:</b> Host should serve food/drink.</li>
                        </ol>`
                } 
            },
                        // === TAMBAHAN FARDHU AIN (ESSENTIAL BASICS) ===
            { 
                id: 'fa1', cat: 'fardhu', icon: 'â˜ï¸', 
                t: {ms:"6 Rukun Iman", en:"The 6 Pillars of Faith"}, 
                c: {
                    ms:`<p>Kepercayaan yang wajib diyakini oleh setiap Muslim:</p>
                        <ol class="step-list">
                            <li><b>Beriman kepada Allah:</b> Yakin Allah itu Esa, Tiada sekutu.</li>
                            <li><b>Beriman kepada Malaikat:</b> Makhluk cahaya yang taat (Jibril, Mikail, dll).</li>
                            <li><b>Beriman kepada Kitab:</b> Al-Quran, Injil, Taurat, Zabur.</li>
                            <li><b>Beriman kepada Rasul:</b> Utusan Allah (25 Rasul wajib diketahui).</li>
                            <li><b>Beriman kepada Hari Kiamat:</b> Hari pembalasan syurga & neraka.</li>
                            <li><b>Beriman kepada Qada' & Qadar:</b> Ketentuan baik & buruk dari Allah.</li>
                        </ol>`,
                    en:`<p>Articles of Faith every Muslim must believe in:</p>
                        <ol class="step-list">
                            <li><b>Belief in Allah:</b> One God, no partners.</li>
                            <li><b>Belief in Angels:</b> Created from light (Gabriel, Michael, etc).</li>
                            <li><b>Belief in Books:</b> Quran, Gospel, Torah, Psalms.</li>
                            <li><b>Belief in Prophets:</b> Messengers of God.</li>
                            <li><b>Belief in Judgment Day:</b> Resurrection and Afterlife.</li>
                            <li><b>Belief in Destiny:</b> Divine Decree (Good and Bad).</li>
                        </ol>`
                } 
            },
            { 
                id: 'fa2', cat: 'fardhu', icon: 'ğŸ•Œ', 
                t: {ms:"5 Rukun Islam", en:"The 5 Pillars of Islam"}, 
                c: {
                    ms:`<p>Tiang agama yang wajib dilaksanakan:</p>
                        <ol class="step-list">
                            <li><b>Mengucap Dua Kalimah Syahadah:</b> (Tiada Tuhan melainkan Allah, Muhammad Pesuruh Allah).</li>
                            <li><b>Menunaikan Solat 5 Waktu:</b> Subuh, Zohor, Asar, Maghrib, Isyak.</li>
                            <li><b>Mengeluarkan Zakat:</b> Zakat Fitrah & Zakat Harta.</li>
                            <li><b>Berpuasa di Bulan Ramadhan:</b> Menahan diri dari lapar & dahaga.</li>
                            <li><b>Menunaikan Haji:</b> Bagi yang berkemampuan (sekali seumur hidup).</li>
                        </ol>`,
                    en:`<p>The foundations of Islamic practice:</p>
                        <ol class="step-list">
                            <li><b>Shahada:</b> Declaration of Faith.</li>
                            <li><b>Salah:</b> 5 Daily Prayers.</li>
                            <li><b>Zakat:</b> Almsgiving/Charity.</li>
                            <li><b>Sawm:</b> Fasting in Ramadan.</li>
                            <li><b>Hajj:</b> Pilgrimage to Mecca (if able).</li>
                        </ol>`
                } 
            },
            { 
                id: 'fa3', cat: 'fardhu', icon: 'ğŸ’§', 
                t: {ms:"Jenis-jenis Air (Taharah)", en:"Types of Water (Purification)"}, 
                c: {
                    ms:`<p>Tidak semua air boleh dibuat bersuci. Kenali jenisnya:</p>
                        <ul class="step-list">
                            <li><b>Air Mutlak (Suci & Menyucikan):</b> Air hujan, sungai, laut, perigi, salji, embun, mata air. <i>(Sah Wudhu/Mandi)</i>.</li>
                            <li><b>Air Musta'mal:</b> Air yang telah digunakan untuk basuhan wajib. <i>(Suci tapi TIDAK menyucikan)</i>.</li>
                            <li><b>Air Musyammas:</b> Air dalam bekas logam yang terdedah matahari panas. <i>(Makruh digunakan)</i>.</li>
                            <li><b>Air Mutanajis:</b> Air kurang 2 kolah yang terkena najis. <i>(Haram buat bersuci)</i>.</li>
                        </ul>`,
                    en:`<p>Not all water is valid for Wudhu. Know the types:</p>
                        <ul class="step-list">
                            <li><b>Mutlak (Pure & Purifying):</b> Rain, sea, river, well water. <i>(Valid for Wudhu)</i>.</li>
                            <li><b>Musta'mal (Used):</b> Water already used for purification. <i>(Cannot reuse)</i>.</li>
                            <li><b>Mutanajis (Impure):</b> Water contaminated with Najis. <i>(Invalid)</i>.</li>
                        </ul>`
                } 
            },
            { 
                id: 'fa4', cat: 'fardhu', icon: 'ğŸ§¹', 
                t: {ms:"3 Jenis Najis & Cara Cuci", en:"3 Types of Najis & Cleaning"}, 
                c: {
                    ms:`<ol class="step-list">
                            <li><b>Mukhaffafah (Ringan):</b> Air kencing bayi lelaki (bawah 2 tahun, minum susu ibu sahaja).<br><i>Cara: Renjis air mutlak rata ke tempat najis.</i></li>
                            <li><b>Mughallazah (Berat):</b> Anjing, khinzir & keturunannya.<br><i>Cara: Basuh 1x air tanah + 6x air mutlak.</i></li>
                            <li><b>Mutawassitah (Sederhana):</b> Darah, nanah, muntah, arak, air kencing dewasa.<br><i>Cara: Basuh dengan air mutlak hingga hilang bau, warna & rasa.</i></li>
                        </ol>`,
                    en:`<ol class="step-list">
                            <li><b>Light (Mukhaffafah):</b> Baby boy urine.<br><i>Clean: Sprinkle water.</i></li>
                            <li><b>Heavy (Mughallazah):</b> Dog/Pig.<br><i>Clean: 1x Soil water + 6x Pure water.</i></li>
                            <li><b>Medium (Mutawassitah):</b> Blood, urine, vomit.<br><i>Clean: Wash until smell, color, taste gone.</i></li>
                        </ol>`
                } 
            },
            { 
                id: 'fa5', cat: 'fardhu', icon: 'ğŸš«', 
                t: {ms:"Perkara Membatalkan Solat", en:"Invalidators of Prayer"}, 
                c: {
                    ms:`<p>Solat terbatal jika berlaku perkara berikut:</p>
                        <ul class="step-list">
                            <li>Berkata-kata dengan sengaja (walaupun dua huruf).</li>
                            <li>Bergerak 3 kali berturut-turut (anggota besar).</li>
                            <li>Makan atau minum.</li>
                            <li>Terkena najis yang tidak dimaafkan.</li>
                            <li>Terbuka aurat dengan sengaja.</li>
                            <li>Berhadas (kentut/buang air).</li>
                            <li>Berubah niat (memutuskan solat).</li>
                            <li>Murtad (Naudzubillah).</li>
                        </ul>`,
                    en:`<p>Prayer becomes invalid if:</p>
                        <ul class="step-list">
                            <li>Speaking intentionally.</li>
                            <li>3 continuous major movements.</li>
                            <li>Eating or drinking.</li>
                            <li>Najis falls on body/clothes.</li>
                            <li>Awrah becomes exposed.</li>
                            <li>Breaking Wudhu (passing gas etc).</li>
                        </ul>`
                } 
            },
            { 
                id: 'fa6', cat: 'fardhu', icon: 'ğŸ‘•', 
                t: {ms:"Batasan Aurat", en:"Awrah (Modesty Limits)"}, 
                c: {
                    ms:`<p>Bahagian tubuh yang wajib ditutup dari pandangan bukan mahram:</p>
                        <ul class="step-list">
                            <li><b>Lelaki:</b> Antara pusat hingga lutut.</li>
                            <li><b>Wanita:</b> Seluruh tubuh kecuali muka dan dua tapak tangan.</li>
                        </ul>
                        <div class="highlight-box">Syarat Pakaian: Tidak ketat (menampakkan bentuk), tidak jarang (nampak warna kulit).</div>`,
                    en:`<p>Parts of body essential to cover:</p>
                        <ul class="step-list">
                            <li><b>Men:</b> From navel to knees.</li>
                            <li><b>Women:</b> Entire body except face and hands.</li>
                        </ul>
                        <div class="highlight-box">Condition: Cloth must not be transparent or tight fitting.</div>`
                } 
            },
            { 
                id: 'fa7', cat: 'fardhu', icon: 'ğŸ§ ', 
                t: {ms:"Sifat 20 (Mengenal Allah)", en:"20 Attributes of Allah"}, 
                c: {
                    ms:`<p>Sifat wajib bagi Allah yang mesti diketahui:</p>
                        <ul class="step-list">
                            <li><b>Nafsiah (Wujud):</b> Ada.</li>
                            <li><b>Salbiah (Menolak Kekurangan):</b> Qidam (Sedia), Baqa (Kekal), Mukhalafatuhu lilhawadith (Berbeza), Qiyamuhu binafsihi (Berdiri Sendiri), Wahdaniah (Esa).</li>
                            <li><b>Ma'ani (Makna):</b> Qudrat (Kuasa), Iradat (Kehendak), Ilmu, Hayat (Hidup), Sama' (Mendengar), Basar (Melihat), Kalam (Berkata-kata).</li>
                        </ul>`,
                    en:`<p>Essential attributes of God:</p>
                        <ul class="step-list">
                            <li><b>Existence (Wujud)</b></li>
                            <li><b>Eternity (Qidam & Baqa)</b></li>
                            <li><b>Power (Qudrah) & Will (Iradah)</b></li>
                            <li><b>Knowledge, Life, Hearing, Sight, Speech.</b></li>
                        </ul>`
                } 
            },
            { 
                id: 'fa8', cat: 'fardhu', icon: 'ğŸ›‘', 
                t: {ms:"Tanda-tanda Baligh", en:"Signs of Puberty"}, 
                c: {
                    ms:`<p>Bila seseorang itu dikira 'Mukallaf' (Wajib solat/puasa/tutup aurat)?</p>
                        <ol class="step-list">
                            <li><b>Lelaki & Perempuan:</b> Bermimpi hingga keluar air mani (ihtilam) - Umur 9 tahun ke atas.</li>
                            <li><b>Perempuan Sahaja:</b> Keluar darah Haid - Umur 9 tahun ke atas.</li>
                            <li><b>Jika Tiada Tanda:</b> Apabila cukup umur 15 tahun Qamariah (Hijrah).</li>
                        </ol>`,
                    en:`<p>When does Islamic obligation (Mukallaf) begin?</p>
                        <ol class="step-list">
                            <li><b>Wet Dream:</b> From age 9+.</li>
                            <li><b>Menstruation (Girls):</b> From age 9+.</li>
                            <li><b>Age Limit:</b> Reaching 15 lunar years if no physical signs occur.</li>
                        </ol>`
                } 
            },
             { 
                id: 'fa9', cat: 'fardhu', icon: 'â“', 
                t: {ms:"Syarat Wajib vs Sah Solat", en:"Conditions of Prayer"}, 
                c: {
                    ms:`<h4 class="bold-term">Syarat Wajib (Siapa Kena Solat?):</h4>
                        <ul class="step-list">
                            <li>Islam.</li>
                            <li>Baligh (Cukup umur).</li>
                            <li>Berakal (Waras).</li>
                            <li>Suci dari Haid/Nifas.</li>
                        </ul>
                        <h4 class="bold-term">Syarat Sah (Bila Solat Jadi Sah?):</h4>
                        <ul class="step-list">
                            <li>Yakin masuk waktu.</li>
                            <li>Menutup aurat.</li>
                            <li>Suci badan/pakaian/tempat dari najis.</li>
                            <li>Suci dari hadas (Wudhu).</li>
                            <li>Mengadap Kiblat.</li>
                        </ul>`,
                    en:`<h4 class="bold-term">Obligatory Conditions (Who?):</h4>
                        <ul class="step-list">
                            <li>Muslim, Puberty, Sane, Clean from Haid.</li>
                        </ul>
                        <h4 class="bold-term">Validity Conditions (How?):</h4>
                        <ul class="step-list">
                            <li>Prayer time has started.</li>
                            <li>Covering Awrah.</li>
                            <li>Free from Najis.</li>
                            <li>Valid Wudhu.</li>
                            <li>Facing Qibla.</li>
                        </ul>`
                } 
            },
            { 
                id: 'fa10', cat: 'fardhu', icon: 'âš–ï¸', 
                t: {ms:"Perbezaan Hadas Kecil & Besar", en:"Minor vs Major Impurity"}, 
                c: {
                    ms:`<ul class="step-list">
                            <li><b>Hadas Kecil:</b> Perkara yang membatalkan wudhu (kentut, buang air, tidur tak tetap punggung).<br><i>Cara Suci: Wudhu.</i></li>
                            <li><b>Hadas Besar:</b> Haid, nifas, wiladah, keluar mani, bersetubuh.<br><i>Cara Suci: Mandi Wajib.</i></li>
                        </ul>
                        <div class="highlight-box">Haram solat & pegang Quran jika berhadas (kecil atau besar).</div>`,
                    en:`<ul class="step-list">
                            <li><b>Minor Impurity:</b> Gas, toilet, deep sleep.<br><i>Cure: Wudhu.</i></li>
                            <li><b>Major Impurity:</b> Menstruation, postpartum, intercourse.<br><i>Cure: Ghusl (Full Bath).</i></li>
                        </ul>`
                } 
                    }
            

          
        ];

        // --- 3. FUNCTIONS ---
        function init() {
            document.documentElement.setAttribute('data-theme', state.theme);
            document.getElementById('langBtn').textContent = state.lang.toUpperCase();
            renderCats();
            renderLibrary();
        }

        function toggleLang() {
            state.lang = state.lang === 'en' ? 'ms' : 'en';
            localStorage.setItem('p100_lang', state.lang);
            document.getElementById('langBtn').textContent = state.lang.toUpperCase();
            renderCats();
            renderLibrary();
        }

        function toggleTheme() {
            state.theme = state.theme === 'light' ? 'dark' : 'light';
            localStorage.setItem('p100_theme', state.theme);
            document.documentElement.setAttribute('data-theme', state.theme);
        }

        function renderCats() {
            const c = document.getElementById('catContainer');
            const map = TEXT[state.lang].cats;
            const keys = ['all', 'asas', 'fardhu', 'sunat', 'surah', 'doa', 'sirah', 'tokoh', 'adab'];
            c.innerHTML = keys.map(k => `<div class="nav-pill ${state.currentCat===k?'active':''}" onclick="setCat('${k}')">${map[k]}</div>`).join('');
        }

        function setCat(k) { state.currentCat = k; renderCats(); renderLibrary(); }

        function renderLibrary() {
            const g = document.getElementById('libraryGrid');
            const q = document.getElementById('searchInput').value.toLowerCase();
            const list = LIBRARY.filter(i => (state.currentCat==='all' || i.cat===state.currentCat) && (i.t[state.lang].toLowerCase().includes(q)));
            
            document.getElementById('libStats').textContent = `${list.length} Articles`;
            
            if(!list.length) { g.innerHTML = '<div style="grid-column:1/-1;text-align:center;padding:20px;opacity:0.6">No results</div>'; return; }

            g.innerHTML = list.map(i => {
                const isSaved = state.saved.includes(i.id) ? 'saved' : '';
                return `
                <div class="book-card ${isSaved}" onclick="openRead('${i.id}')">
                    <div class="saved-badge">â™¥</div>
                    <div class="book-icon">${i.icon}</div>
                    <div class="book-info">
                        <div class="book-title">${i.t[state.lang]}</div>
                        <span class="tag tag-${i.cat}">${TEXT[state.lang].cats[i.cat]}</span>
                    </div>
                </div>`;
            }).join('');
        }

        // --- UPDATED READER FUNCTIONS WITH HISTORY SUPPORT ---
        function openRead(id) {
            addHistoryState(); // Add history entry so back button works
            const item = LIBRARY.find(i => i.id === id);
            state.currentId = id;
            document.getElementById('artTitle').innerHTML = item.t[state.lang];
            document.getElementById('artContent').innerHTML = item.c[state.lang];
            document.getElementById('readerModal').classList.add('open');
            updBtn();
        }

        function closeReader() {
            // Check if we have history state to pop (Smart Closing)
            if (history.state && history.state.modal) {
                history.back(); // This triggers onpopstate, which closes the modal
            } else {
                // Fallback if opened without history
                document.getElementById('readerModal').classList.remove('open');
            }
        }

        function toggleSaveCurrent() {
            if(!state.currentId) return;
            const idx = state.saved.indexOf(state.currentId);
            if(idx > -1) state.saved.splice(idx,1); else state.saved.push(state.currentId);
            localStorage.setItem('p100_saved', JSON.stringify(state.saved));
            updBtn(); renderLibrary(); renderSaved();
            showToast(idx > -1 ? "Removed" : "Saved");
        }

        function updBtn() {
            const isSaved = state.saved.includes(state.currentId);
            const btn = document.getElementById('bookmarkBtn');
            btn.style.color = isSaved ? 'var(--primary)' : 'var(--text)';
        }

        function switchView(v) {
            document.getElementById('mainView').style.display = v==='home'?'block':'none';
            document.getElementById('savedView').style.display = v==='saved'?'block':'none';
            document.getElementById('nav-home').className = `nav-item ${v==='home'?'active':''}`;
            document.getElementById('nav-saved').className = `nav-item ${v==='saved'?'active':''}`;
            if(v==='saved') renderSaved();
        }

        function renderSaved() {
            const g = document.getElementById('savedGrid');
            const list = LIBRARY.filter(i => state.saved.includes(i.id));
            if(!list.length) { g.innerHTML = '<div style="text-align:center;opacity:0.5;padding:20px">No saved items</div>'; return; }
            g.innerHTML = list.map(i => `
                <div class="book-card saved" onclick="openRead('${i.id}')">
                    <div class="saved-badge">â™¥</div>
                    <div class="book-icon">${i.icon}</div>
                    <div class="book-info"><div class="book-title">${i.t[state.lang]}</div><span class="tag tag-${i.cat}">${TEXT[state.lang].cats[i.cat]}</span></div>
                </div>`).join('');
        }

        function adjustFont() {
            state.fontSize = state.fontSize >= 24 ? 16 : state.fontSize + 2;
            document.getElementById('artContent').style.fontSize = state.fontSize + 'px';
        }

        function showToast(msg) {
            const t = document.getElementById('toast');
            t.textContent = msg; t.classList.add('show');
            setTimeout(()=>t.classList.remove('show'), 2000);
        }

        // --- BACK BUTTON LOGIC ---
        function addHistoryState() {
            history.pushState({modal: true}, null, window.location.href);
        }

        window.onpopstate = function(event) {
            const reader = document.getElementById('readerModal');
            if(reader && reader.classList.contains('open')) {
                reader.classList.remove('open');
            }
        };

        init();
    </script>
</body>
</html>
